<div *ngFor="let error of errorMessages" class="alert fade in" [class]="error.type">
  <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
  <span class="sr-only">Error:</span>
  <button type="button" class="close" data-dismiss="alert" aria-label="Close">
    <span aria-hidden="true">&times;</span>
  </button>
  <span id="error" [innerText]="error.text"></span>
</div>


<div class = "row">
  <div class="col-md-12">
    <div style="padding: 4px;" class="row">
      <div class="col-md-2">
        <h4>Row count</h4>
        <p id="rowCount" [innerText]="rowCount"></p><!-- should be textContent-->
      </div>
      <div class="col-md-5 col-md-offset-5 row">
            <div class="row">
              <div class="input-group">
                <span class="glyphicon glyphicon-search input-group-addon" aria-hidden="true"></span>
                <input #searchinput type="text" id="searchInput" class="form-control" placeholder="Type text to query..."/>
                <div class="input-group-btn">
                  <button #searchButton (click)="search(searchinput.value)" class="btn btn-default">Search</button>
                  <button (click)="mark(searchinput.value)" class="btn btn-default">Mark</button>
                </div>
              </div>
            </div>
            <div class="row">
              <div class="col-md-offset-1 col-md-11">
                <div class="checkbox-inline">
                  <input type="checkbox" value=""><label>Order by relevance</label>
                </div>
              </div>
            </div>


      </div>
    </div>
    <div style="clear: both;" class="row"></div>

    <div class="row">
      <form class="form-inline">
        <div class="form-group">
          <label for="from">From</label>
          <input #from type="datetime-local" class="form-control" id="from" placeholder="From" [value]="getDefaultFromValue()" novalidate="true" step=1>
        </div>

        <div class="form-group" style="margin-left:1em">
          <label for="to">To</label>
          <input #to type="datetime-local" class="form-control" id="to" placeholder="To" [value]="getDefaultToValue()" novalidate="true" step=1>
        </div>
        <button (click)="loadByDate(to.value, from.value)" class="btn btn-default" style="margin-left:1em">Search</button>
      </form>
    </div>

    <div style="padding: 4px;" class="toolbar" class="row">
      <button (click)="createRowData()" class="btn btn-default">Refresh Data</button>
      <button [disabled]="!showGrid" (click)="showGrid=false" class="btn btn-default destroyGrid">Destroy Grid</button>
      <button [disabled]="showGrid" (click)="showGrid=true" class="btn btn-default createGrid">Create Grid</button>
    </div>

    <div [hidden]="!showGrid">

      <!-- Because we are using the Angular ID (ie #ag-grid marker), we have to have all the items that use
           that marker inside the same ng-if as the grid -->

      <div style="padding: 4px;" class="toolbar" class="row">
        <div [ngClass]="{'col-md-10': !treeHidden, 'col-md-11': treeHidden}">
            Grid API:
            <button (click)="agGrid.api.selectAll()" class="btn btn-default">Select All</button>
            <button (click)="agGrid.api.deselectAll()" class="btn btn-default">Clear Selection</button>
        </div>
        <div class="col-md-1">
          <button type="button" class="btn btn-default" aria-label="Expand grid" (click)="toggleTree(!treeHidden)">
            <span class="glyphicon glyphicon-resize-horizontal" aria-hidden="true"></span>
          </button>
        </div>
      </div>
      <div style="clear: both;"></div>
      <div class="row">
        <div [ngClass]="{'col-md-10': !treeHidden,'col-md-12': treeHidden}">
          <ag-grid-ng2 #agGrid class="ag-fresh" style="width: 100%; height: 40em;"

                       [gridOptions]="gridOptions"
                       [columnDefs]="columnDefs"
                       [showToolPanel]="showToolPanel"
                       [rowData]="rowData"

                       enableColResize
                       enableSorting
                       enableFilter
                       groupHeaders
                       suppressRowClickSelection
                       toolPanelSuppressGroups
                       toolPanelSuppressValues
                       debug
                       rowHeight="22"
                       rowSelection="multiple"

                       (modelUpdated)="onModelUpdated()"
                       (cellClicked)="onCellClicked($event)"
                       (cellDoubleClicked)="onCellDoubleClicked($event)"
                       (cellContextMenu)="onCellContextMenu($event)"
                       (cellValueChanged)="onCellValueChanged($event)"
                       (cellFocused)="onCellFocused($event)"
                       (rowSelected)="onRowSelected($event)"
                       (selectionChanged)="onSelectionChanged()"
                       (beforeFilterChanged)="onBeforeFilterChanged()"
                       (afterFilterChanged)="onAfterFilterChanged()"
                       (filterModified)="onFilterModified()"
                       (beforeSortChanged)="onBeforeSortChanged()"
                       (afterSortChanged)="onAfterSortChanged()"
                       (virtualRowRemoved)="onVirtualRowRemoved($event)"
                       (rowClicked)="onRowClicked($event)"
                       (ready)="onReady($event)"

                       (columnEverythingChanged)="onColumnEvent($event)"
                       (columnRowGroupChanged)="onColumnEvent($event)"
                       (columnValueChanged)="onColumnEvent($event)"
                       (columnMoved)="onColumnEvent($event)"
                       (columnVisible)="onColumnEvent($event)"
                       (columnGroupOpened)="onColumnEvent($event)"
                       (columnResized)="onColumnEvent($event)"
                       (columnPinnedCountChanged)="onColumnEvent($event)">
          </ag-grid-ng2>
        </div>
        <div id="tree" style="overflow:scroll" [ngClass]="{'col-md-2': !treeHidden,'col-md-0': treeHidden}">
          <h4>Source Files</h4>
          <files-tree [directories] = "directories" (checked)="dirChecked($event)" (unchecked)="dirUnchecked($event)"></files-tree>
        </div>
      </div>
      <div class="row">
          <button *ngIf="showLoadMore" (click)="loadMore(true)" class="btn btn-default"><span class="glyphicon glyphicon-arrow-down"></span> Load earlier</button>
          <button *ngIf="showLoadEarlier" (click)="loadMore(false)" class="btn btn-default"  style="float:right">Load later <span class="glyphicon glyphicon-arrow-up"></span></button>
      </div>
    </div>
  </div>
</div>
