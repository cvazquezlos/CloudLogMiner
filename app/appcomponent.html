<div [hidden]="!errorMessage.text" class="alert fade in" [class]="errorMessage.type">
    <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
    <span class="sr-only">Error:</span>
    <button type="button" class="close" data-dismiss="alert" aria-label="Close">
        <span aria-hidden="true">&times;</span>
    </button>
    <span id="errorMessage" [innerText]="errorMessage.text"></span>
</div>


<div class = "row">
<div class="col-md-12 nopadding">
    <div class="row"><h1>Cloud Log Miner</h1></div>
    <div style="padding: 4px;" class="row">
        <div class="col-md-2 nopadding">
            <h4>Row count</h4>
            <p id="rowCount" [innerText]="rowCount"></p><!-- should be textContent-->
        </div>
        <div class="col-md-5 col-md-offset-5 row nopadding">
            <form class="form-inline">
                <div class="col-md-7 nopadding">
                    <div class="row">
                        <div class="input-group" style="width:100%">
                            <span class="glyphicon glyphicon-search input-group-addon" aria-hidden="true"></span>
                            <input #searchinput type="text" id="searchInput" class="form-control" placeholder="Type text to query..."/>
                        </div>
                    </div>
                    <div class="row">
                        <div class="checkbox col-md-offset-2 col-md-11 nopadding">
                            <label>
                                <input type="checkbox" (change)="searchByRelevance=$event.target.checked"/> Order by relevance
                            </label>
                        </div>
                    </div>
                </div>
                <div class="col-md-5 row">
                    <button #searchButton (click)="search(searchinput.value)" class="btn btn-default searchButton">Search</button>
                    <button (click)="mark(searchinput.value)" class="btn btn-default">Mark</button>
                </div>
            </form>
        </div>
    </div>
    <div style="clear: both;" class="row"></div>

    <div class="row">
        <form class="form-inline">
            <div class="form-group">
                <label for="from">From</label>
                <input #from type="datetime-local" class="form-control" id="from" placeholder="From" [value]="getDefaultFromValue()" novalidate="true" step=1>
            </div>

            <div class="form-group" style="margin-left:1em">
                <label for="to">To</label>
                <input #to type="datetime-local" class="form-control" id="to" placeholder="To" [value]="getDefaultToValue()" novalidate="true" step=1>
            </div>
            <button (click)="loadByDate(to.value, from.value)" class="btn btn-default searchByDate" style="margin-left:1em">Search</button>
        </form>
    </div>

    <div class="row" [hidden]="!errorMessage">
        <!--<p id="errorMessage" style="color:red" [innerText]="errorMessage"></p>-->
    </div>

    <div style="padding: 4px;" class="toolbar" class="row">
        <button (click)="createRowData()" class="btn btn-default">Refresh Data</button>
        <button [disabled]="!showGrid" (click)="showGrid=false" class="btn btn-default destroyGrid">Destroy Grid</button>
        <button [disabled]="showGrid" (click)="showGrid=true" class="btn btn-default createGrid">Create Grid</button>
    </div>

    <div [hidden]="!showGrid">

        <!-- Because we are using the Angular ID (ie #ag-grid marker), we have to have all the items that use
             that marker inside the same ng-if as the grid -->

        <div style="padding: 4px;" class="toolbar" class="row">
            <span>
                Grid API:
                <button (click)="agGrid.api.selectAll()" class="btn btn-default">Select All</button>
                <button (click)="agGrid.api.deselectAll()" class="btn btn-default">Clear Selection</button>
            </span>
        </div>
        <div style="clear: both;"></div>
        <div class="row">
            <div class="col-md-10 nopadding">
                <ag-grid-ng2 #agGrid class="ag-fresh" style="width: 100%; height: 60%;"

                         [gridOptions]="gridOptions"
                         [columnDefs]="columnDefs"
                         [showToolPanel]="showToolPanel"
                         [rowData]="rowData"

                         enableColResize
                         enableSorting
                         enableFilter
                         groupHeaders
                         suppressRowClickSelection
                         toolPanelSuppressGroups
                         toolPanelSuppressValues
                         debug
                         rowHeight="22"
                         rowSelection="multiple"

                         (modelUpdated)="onModelUpdated()"
                         (cellClicked)="onCellClicked($event)"
                         (cellDoubleClicked)="onCellDoubleClicked($event)"
                         (cellContextMenu)="onCellContextMenu($event)"
                         (cellValueChanged)="onCellValueChanged($event)"
                         (cellFocused)="onCellFocused($event)"
                         (rowSelected)="onRowSelected($event)"
                         (selectionChanged)="onSelectionChanged()"
                         (beforeFilterChanged)="onBeforeFilterChanged()"
                         (afterFilterChanged)="onAfterFilterChanged()"
                         (filterModified)="onFilterModified()"
                         (beforeSortChanged)="onBeforeSortChanged()"
                         (afterSortChanged)="onAfterSortChanged()"
                         (virtualRowRemoved)="onVirtualRowRemoved($event)"
                         (rowClicked)="onRowClicked($event)"
                         (ready)="onReady($event)"

                         (columnEverythingChanged)="onColumnEvent($event)"
                         (columnRowGroupChanged)="onColumnEvent($event)"
                         (columnValueChanged)="onColumnEvent($event)"
                         (columnMoved)="onColumnEvent($event)"
                         (columnVisible)="onColumnEvent($event)"
                         (columnGroupOpened)="onColumnEvent($event)"
                         (columnResized)="onColumnEvent($event)"
                         (columnPinnedCountChanged)="onColumnEvent($event)">
                </ag-grid-ng2>
            </div>
            <div id="tree" style="overflow:scroll" class="col-md-2 nopadding">
                <h4>Source Files</h4>
                <files-tree [directories] = "directories" (checked)="dirChecked($event)" (unchecked)="dirUnchecked($event)"></files-tree>
            </div>
        </div>
        <div class="row"><button *ngIf="showLoadMore" (click)="loadMore()" class="btn btn-default" style="margin-left:40%">Load more</button></div>
    </div>
</div>
</div>
